<div class="container">

<div class="container">
  <div class="row justify-content-center">
    <div class="col-sm-8">
      <%= form_tag agents_path, method: :get do %>
        <%= text_field_tag :query,
          params[:query],
          class: "form-control mt-4 mb-3",
          placeholder: "Find an agent by name, category or location"
        %>
        <%= submit_tag "Search", class: "btn btn-main" %>
      <% end %>
    </div>
  </div>
</div>

  <h2 class="mt-4">All available agents</h2>
  <br>
  <br>
  <%= button_to "Create New Agent", new_agent_path, :method => "get", class: "btn btn-main" %>
  <br>
  <br>
  <div class="d-flex">
    <div class="cards">
      <% @agents.each do |agent| %>
        <%= link_to agent_path(agent), class: "text-decoration-none text-dark" do %>
          <div class="card-agent">
            <% if agent.photo.attached? %>
              <%= cl_image_tag agent.photo.key, crop: :fill %>
            <% else %>
              <%= image_tag "/assets/default_agent.png" %>
            <% end %>
            <div class="card-agent-infos">
              <div>
                <h2><%= agent.name %></h2>
                <p><%= agent.category %></p>
              </div>
                <h2 class="card-agent-pricing">Â£<%= agent.price %></h2>
            </div>
          </div>
        <% end %>
      <% end %>
    </div>

    <div class="map" style="width: 100%; height: 700px;"
      data-controller="mapbox"
      data-mapbox-markers-value="<%= @markers.to_json %>"
      data-mapbox-api-key-value="<%= ENV['MAPBOX_API_KEY'] %>">
    </div>
  </div>
</div>
